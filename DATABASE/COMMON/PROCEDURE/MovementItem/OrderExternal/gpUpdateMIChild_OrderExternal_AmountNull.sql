-- Function: gpUpdateMIChild_OrderExternal_AmountNull()

DROP FUNCTION IF EXISTS gpUpdateMIChild_OrderExternal_AmountNull (Integer, TVarChar);


CREATE OR REPLACE FUNCTION gpUpdateMIChild_OrderExternal_AmountNull(
    IN inMovementId      Integer      , -- ключ Документа
    IN inSession         TVarChar       -- сессия пользователя
)
RETURNS VOID
AS
$BODY$
   DECLARE vbUserId Integer;
BEGIN
--return;
     -- проверка прав пользователя на вызов процедуры
     vbUserId := lpCheckRight (inSession, zc_Enum_Process_InsertUpdate_MI_OrderExternalUnit());

    -- сохранили
   PERFORM lpInsertUpdate_MovementItem (MovementItem.Id, zc_MI_Child(), MovementItem.ObjectId, inMovementId, Null, MovementItem.ParentId);
         , lpInsertUpdate_MovementItemFloat (zc_MIFloat_AmountSecond(), MovementItem.Id, Null)  -- сохранили свойство <Количество дозаказ>
   FROM MovementItem
   WHERE MovementItem.MovementId = inMovementId
     AND MovementItem.DescId = zc_MI_Child()
     AND MovementItem.isErased = FALSE 
    ;

END;
$BODY$
  LANGUAGE PLPGSQL VOLATILE;

/*
 ИСТОРИЯ РАЗРАБОТКИ: ДАТА, АВТОР
               Фелонюк И.В.   Кухтин И.В.   Климентьев К.И..
 05.07.22         *
*/

-- тест